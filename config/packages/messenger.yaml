framework:
    messenger:
        default_bus: messenger.bus.default

        buses:
            messenger.bus.default: []

        # Where failed jobs go
        failure_transport: failed

        transports:
            # Main async queue (Doctrine)
            async:
                dsn: 'doctrine://default?queue_name=async'
                retry_strategy:
                    max_retries: 5
                    multiplier: 2

            # Failed messages
            failed:
                dsn: 'doctrine://default?queue_name=failed'

        routing:
            # Built-in Symfony messages → async
            Symfony\Component\Mailer\Messenger\SendEmailMessage: async
            Symfony\Component\Notifier\Message\ChatMessage: async
            Symfony\Component\Notifier\Message\SmsMessage: async

            # Your Shopify sync messages → async queue
            App\Product\Message\ProductSyncMessage: async
